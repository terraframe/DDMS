<version xsi:noNamespaceSchemaLocation="../../profiles/version_gis.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <doIt>
  
    <delete>

      <object
        key="dss.vector.solutions.LineStyle"
        type="com.runwaysdk.system.metadata.MdBusiness"/>
      <object
        key="dss.vector.solutions.query.TextStyle"
        type="com.runwaysdk.system.metadata.MdBusiness"/>
      <object
        key="dss.vector.solutions.PointStyle"
        type="com.runwaysdk.system.metadata.MdBusiness"/>
      <object
        key="dss.vector.solutions.PolygonStyle"
        type="com.runwaysdk.system.metadata.MdBusiness"/>
      <object
        key="dss.vector.solutions.query.GeometryStyle"
        type="com.runwaysdk.system.metadata.MdBusiness"/>
         
      <object
        key="dss.vector.solutions.query.StyleRule"
        type="com.runwaysdk.system.metadata.MdBusiness"/>  
        
      <object
        key="dss.vector.solutions.query.MappingController.updateLayer"
        type="com.runwaysdk.system.metadata.MdAction"/>
      <object
        key="dss.vector.solutions.query.Layer.updateLayer"
        type="com.runwaysdk.system.metadata.MdMethod"/>    
    
      <object
        key="dss.vector.solutions.query.DefinesLayers"
        type="com.runwaysdk.system.metadata.MdRelationship" />

      <object
        key="dss.vector.solutions.query.DefinesCategories"
        type="com.runwaysdk.system.metadata.MdRelationship" />
        
      <object
        key="dss.vector.solutions.query.ThematicLayer"
        type="com.runwaysdk.system.metadata.MdBusiness"/>
      <object
        key="dss.vector.solutions.query.UniversalLayer"
        type="com.runwaysdk.system.metadata.MdBusiness"/>
      
      <object
        key="dss.vector.solutions.query.SavedSearchView.thematicLayer"
        type="com.runwaysdk.system.metadata.MdAttribute"/>
      <object
        key="dss.vector.solutions.query.SavedSearchView.thematicLayerId"
        type="com.runwaysdk.system.metadata.MdAttribute"/>
      <object
        key="dss.vector.solutions.query.SavedSearch.thematicLayer"
        type="com.runwaysdk.system.metadata.MdAttribute"/>
      
      <object
        key="dss.vector.solutions.query.Layer.geometryStyle"
        type="com.runwaysdk.system.metadata.MdAttribute"/>
      <object
        key="dss.vector.solutions.query.Layer.textStyle"
        type="com.runwaysdk.system.metadata.MdAttribute"/>       
      
      <object
        key="dss.vector.solutions.query.LayerView.isThematic"
        type="com.runwaysdk.system.metadata.MdAttribute"/>
        
      <object
        key="dss.vector.solutions.query.LayerView.thematicType"
        type="com.runwaysdk.system.metadata.MdAttribute"/>              
        
      <object
        key="dss.vector.solutions.query.SavedSearch.getAllLayers"
        type="com.runwaysdk.system.metadata.MdMethod"/>
        
      <object
        key="dss.vector.solutions.irs.ZoneSpray.mapQuery"
        type="com.runwaysdk.system.metadata.MdMethod"/>
      <object
        key="dss.vector.solutions.intervention.monitor.SurveyPoint.mapQuery"
        type="com.runwaysdk.system.metadata.MdMethod"/>
      <object
        key="dss.vector.solutions.query.QueryBuilder.mapQuery"
        type="com.runwaysdk.system.metadata.MdMethod"/>        

      <object
        key="dss.vector.solutions.LineStyleController"
        type="com.runwaysdk.system.metadata.MdController"/>
        
      <object
        key="dss.vector.solutions.PointStyleController"
        type="com.runwaysdk.system.metadata.MdController"/>
        
      <object
        key="dss.vector.solutions.PolygonStyleController"
        type="com.runwaysdk.system.metadata.MdController"/>
        
      <object
        key="dss.vector.solutions.query.GeometryStyleController"
        type="com.runwaysdk.system.metadata.MdController"/>
        
      <object
        key="dss.vector.solutions.query.DefinesCategoriesController"
        type="com.runwaysdk.system.metadata.MdController"/>
        
      <object
        key="dss.vector.solutions.query.DefinesLayersController"
        type="com.runwaysdk.system.metadata.MdController"/>
        
      <object
        key="dss.vector.solutions.query.StyleRuleController"
        type="com.runwaysdk.system.metadata.MdController"/>
        
      <object
        key="dss.vector.solutions.query.TextStyleController"
        type="com.runwaysdk.system.metadata.MdController"/>
        
      <object
        key="dss.vector.solutions.query.ThematicLayerController"
        type="com.runwaysdk.system.metadata.MdController"/>
        
      <object
        key="dss.vector.solutions.query.UniversalLayerController"
        type="com.runwaysdk.system.metadata.MdController"/>
    

      
    </delete>
  
    <create>

      <mdBusiness
        name="dss.vector.solutions.query.SavedMap"
        label="Saved Map"
        description="Represents a persisted saved map with zero or more layers.">
        <attributes>
          <char
            name="mapName"
            label="Map Name"
            size="50"
            required="true" />
        </attributes>
        <mdMethod
          name="getAllLayers"
          label="Get All Layers"
          description="Get All Layers"
          static="false"
          returnType="dss.vector.solutions.query.LayerViewQuery">
        </mdMethod>
        <mdMethod
          name="cleanOldViews"
          label="Clean Old Views"
          description="Removes all the DB views from prior mapping."
          static="true"
          returnType="void">
        </mdMethod>
      </mdBusiness>
      
      <mdRelationship
        name="dss.vector.solutions.query.HasLayers"
        label="Has Layers"
        composition="true">
        <attributes>
          <integer
            name="layerPosition"
            label="Position"
            description="The layer's position relative to the other layers."
            required="true"
            rejectNegative="true"/>
        </attributes>
        <parent cardinality="1" name="dss.vector.solutions.query.SavedMap" method="Map"/>
        <child cardinality="*" name="dss.vector.solutions.query.Layer" method="Layer"/>
      </mdRelationship>
    
      <mdRelationship
        name="dss.vector.solutions.query.HasCategories"
        composition="true"
        label="Has Categories"
        description="Relationship between a Layer and the Categories (for coloring) it defines.">
        <parent
          cardinality="1"
          name="dss.vector.solutions.query.Layer"
          method="FromLayer" />
        <child
          cardinality="*"
          name="dss.vector.solutions.query.AbstractCategory"
          method="HasCategory" />
      </mdRelationship>        
    
      <mdBusiness
        name="dss.vector.solutions.query.Styles"
        label="Styles"
        description="Styles for SLD and mapping.">
        <attributes>
          <!-- Point -->
          <char
            name="pointStroke"
            label="Point Stroke"
            description="The stroke color for a point"
            required="true"
            defaultValue="#7F7F7F"
            size="7" />
          <integer
            name="pointWidth"
            label="Point Stroke Width"
            description="The width of the point."
            required="true"
            defaultValue="2" />
          <enumeration
            name="pointMarker"
            label="Point Marker"
            description="Point Marker"
            required="true"
            type="dss.vector.solutions.query.WellKnownNames"
            defaultValue="CIRCLE" />
          <!--  Polygon -->
          <char
            name="polygonStroke"
            label="Polygon Stroke"
            description="The stroke color for a polygon"
            required="true"
            defaultValue="#7F7F7F"
            size="7" />
          <integer
            name="polygonWidth"
            label="Polygon Stroke Width"
            description="The width of the polygon."
            required="true"
            defaultValue="2" />
          <char
            name="polygonFill"
            label="Polygon Fill"
            description="The fill color"
            required="true"
            defaultValue="#FFFFFF"
            size="7" />
          <!-- Text -->
          <char
            name="fontFamily"
            label="Font Family"
            description="Font Family"
            required="true"
            defaultValue="Times New Roman"
            size="50" />
          <char
            name="fontStyle"
            label="Font Style"
            description="Font Style"
            required="true"
            defaultValue="Normal"
            size="50" />
          <integer
            name="fontSize"
            label="Font Size"
            description="The font size"
            required="true"
            rejectNegative="true"
            rejectZero="true"
            defaultValue="14" />
          <char
            name="fill"
            label="Fill"
            description="The fill color"
            required="true"
            defaultValue="#000000"
            size="7" />
        </attributes>
      </mdBusiness>        
    
    </create>
    <update>

      <mdView name="dss.vector.solutions.query.LayerView">
        <create>
          <attributes>
            <virtual
              concrete="layerPosition"
              type="dss.vector.solutions.query.HasLayers"/>
          </attributes>
        </create>
      </mdView>    
      
      <mdBusiness name="dss.vector.solutions.query.SavedSearch">
        
        <create>
          <attributes>
            <boolean
              name="mappable"
              label="Mappable"
              defaultValue="false"
              required="true"
              description="Denotes if the search can be mapped or not."/>
          </attributes>
          
          <mdMethod
            name="getMappableSearches"
            label="Get Mappable Searches"
            description="Returns all saved searches that can be mapped."
            static="true"
            returnType="dss.vector.solutions.query.SavedSearchViewQuery">
          </mdMethod>
        </create>
      
      </mdBusiness>

      <mdBusiness
        name="dss.vector.solutions.geo.generated.GeoEntity">
        <create>
          <attributes>
            <clob
              name="geoData"
              label="Geometry Data"
              required="false" />
          </attributes>
        </create>
      </mdBusiness>
      
      <mdBusiness
        name="dss.vector.solutions.query.Layer"
        isAbstract="false">
        <create>
          <attributes>
            <reference
              name="savedSearch"
              label="Saved Search"
              required="true"
              type="dss.vector.solutions.query.SavedSearch" />
	          <reference
	            name="thematicVariable"
	            label="Thematic Variable"
	            required="false"
	            type="dss.vector.solutions.query.ThematicVariable" />
	          <boolean
	            name="viewCreated"
	            label="View Created"
	            description="Denotes if a database view has been created for the thematic layer."
	            required="true"
	            defaultValue="false"
	            type="java.lang.Boolean"
	            positiveLabel="Yes"
	            negativeLabel="No" />
            <reference
              name="defaultStyles"
              label="Default Styles"
              required="true"
              type="dss.vector.solutions.query.Styles" />  
          </attributes>
        </create>
      </mdBusiness>
      
      <mdBusiness
        name="dss.vector.solutions.query.AbstractCategory">
        <create>
          <attributes>
            <reference
              name="styles"
              label="Styles"
              required="true"
              type="dss.vector.solutions.query.Styles"/>
          </attributes>
        </create>
      </mdBusiness>      
      
    </update>
    
  </doIt>
  <undoIt>
    <delete></delete>
  </undoIt>
</version>

(function(){var Y=YAHOO,YU=Y.util,YL=Y.lang,_logOverwriteError;if(!YU.Storage){_logOverwriteError=function(fxName){Y.log('Exception in YAHOO.util.Storage.?? - must be extended by a storage engine'.replace('??',fxName).replace('??',this.getName?this.getName():'Unknown'),'error');};YU.Storage=function(location,name,conf){var that=this;Y.env._id_counter+=1;that._cfg=YL.isObject(conf)?conf:{};that._location=location;that._name=name;that.isReady=false;that.createEvent(that.CE_READY,{scope:that});that.createEvent(that.CE_CHANGE,{scope:that});that.subscribe(that.CE_READY,function(){that.isReady=true;});};YU.Storage.prototype={CE_READY:'YUIStorageReady',CE_CHANGE:'YUIStorageChange',DELIMITER:'__',_cfg:'',_name:'',_location:'',length:0,isReady:false,clear:function(){this._clear();this.length=0;},getItem:function(key){Y.log("Fetching item at  "+key);var item=this._getItem(key);return YL.isValue(item)?this._getValue(item):null;},getName:function(){return this._name;},hasKey:function(key){return YL.isString(key)&&this._hasKey(key);},key:function(index){Y.log("Fetching key at "+index);if(YL.isNumber(index)&&-1<index&&this.length>index){var value=this._key(index);if(value){return value;}}
throw('INDEX_SIZE_ERR - Storage.setItem - The provided index ('+index+') is not available');},removeItem:function(key){Y.log("removing "+key);if(this.hasKey(key)){var oldValue=this._getItem(key);if(!oldValue){oldValue=null;}
this._removeItem(key);this.fireEvent(this.CE_CHANGE,new YU.StorageEvent(this,key,oldValue,null,YU.StorageEvent.TYPE_REMOVE_ITEM));}
else{}},setItem:function(key,data){Y.log("SETTING "+data+" to "+key);if(YL.isString(key)){var eventType=this.hasKey(key)?YU.StorageEvent.TYPE_UPDATE_ITEM:YU.StorageEvent.TYPE_ADD_ITEM,oldValue=this._getItem(key);if(!oldValue){oldValue=null;}
if(this._setItem(key,this._createValue(data))){this.fireEvent(this.CE_CHANGE,new YU.StorageEvent(this,key,oldValue,data,eventType));}
else{throw('QUOTA_EXCEEDED_ERROR - Storage.setItem - The choosen storage method ('+
this.getName()+') has exceeded capacity');}}
else{}},_clear:function(){_logOverwriteError('_clear');return'';},_createValue:function(s){var type=(YL.isNull(s)||YL.isUndefined(s))?(''+s):typeof s;return'string'===type?s:type+this.DELIMITER+s;},_getItem:function(key){_logOverwriteError('_getItem');return'';},_getValue:function(s){var a=s?s.split(this.DELIMITER):[];if(1==a.length){return s;}
switch(a[0]){case'boolean':return'true'===a[1];case'number':return parseFloat(a[1]);case'null':return null;default:return a[1];}},_key:function(index){_logOverwriteError('_key');return'';},_hasKey:function(key){return null!==this._getItem(key);},_removeItem:function(key){_logOverwriteError('_removeItem');return'';},_setItem:function(key,data){_logOverwriteError('_setItem');return'';}};YL.augmentProto(YU.Storage,YU.EventProvider);}}());(function(){var Y=YAHOO.util,YL=YAHOO.lang,_locationEngineMap={},_registeredEngineSet=[],_registeredEngineMap={},_getClass=function(klass){return(klass&&klass.isAvailable())?klass:null;},_getStorageEngine=function(location,klass,conf){var engine=_locationEngineMap[location+klass.ENGINE_NAME];if(!engine){engine=new klass(location,conf);_locationEngineMap[location+klass.ENGINE_NAME]=engine;}
return engine;},_getValidLocation=function(location){switch(location){case Y.StorageManager.LOCATION_LOCAL:case Y.StorageManager.LOCATION_SESSION:return location;default:return Y.StorageManager.LOCATION_SESSION;}};Y.StorageManager={LOCATION_SESSION:'sessionStorage',LOCATION_LOCAL:'localStorage',get:function(engineType,location,conf){var _cfg=YL.isObject(conf)?conf:{},klass=_getClass(_registeredEngineMap[engineType]);if(!klass&&!_cfg.force){var i,j;if(_cfg.order){j=_cfg.order.length;for(i=0;i<j&&!klass;i+=1){klass=_getClass(_cfg.order[i]);}}
if(!klass){j=_registeredEngineSet.length;for(i=0;i<j&&!klass;i+=1){klass=_getClass(_registeredEngineSet[i]);}}}
if(klass){return _getStorageEngine(_getValidLocation(location),klass,_cfg.engine);}
throw('YAHOO.util.StorageManager.get - No engine available, please include an engine before calling this function.');},getByteSize:function(s){return encodeURIComponent(''+s).length;},register:function(engineConstructor){if(YL.isFunction(engineConstructor)&&YL.isFunction(engineConstructor.isAvailable)&&YL.isString(engineConstructor.ENGINE_NAME)){_registeredEngineMap[engineConstructor.ENGINE_NAME]=engineConstructor;_registeredEngineSet.push(engineConstructor);return true;}
return false;}};YAHOO.register("StorageManager",Y.SWFStore,{version:"2.8.0r4",build:"2449"});}());(function(){YAHOO.util.StorageEvent=function(storageArea,key,oldValue,newValue,type){this.key=key;this.oldValue=oldValue;this.newValue=newValue;this.url=window.location.href;this.window=window;this.storageArea=storageArea;this.type=type;};YAHOO.lang.augmentObject(YAHOO.util.StorageEvent,{TYPE_ADD_ITEM:'addItem',TYPE_REMOVE_ITEM:'removeItem',TYPE_UPDATE_ITEM:'updateItem'});YAHOO.util.StorageEvent.prototype={key:null,newValue:null,oldValue:null,source:null,storageArea:null,type:null,url:null};}());(function(){var Y=YAHOO.util,YL=YAHOO.lang;Y.StorageEngineKeyed=function(){Y.StorageEngineKeyed.superclass.constructor.apply(this,arguments);this._keys=[];this._keyMap={};};YL.extend(Y.StorageEngineKeyed,Y.Storage,{_keys:null,_keyMap:null,_addKey:function(key){this._keyMap[key]=this.length;this._keys.push(key);this.length=this._keys.length;},_indexOfKey:function(key){var i=this._keyMap[key];return undefined===i?-1:i;},_removeKey:function(key){var j=this._indexOfKey(key),rest=this._keys.slice(j+1);delete this._keyMap[key];for(var k in this._keyMap){if(j<this._keyMap[k]){this._keyMap[k]-=1;}}
this._keys.length=j;this._keys=this._keys.concat(rest);this.length=this._keys.length;}});}());(function(){var Y=YAHOO.util,YL=YAHOO.lang,_beginTransaction=function(engine){if(engine.begin){engine.begin();}},_commitTransaction=function(engine){if(engine.commit){engine.commit();}};Y.StorageEngineHTML5=function(location,conf){var _this=this;Y.StorageEngineHTML5.superclass.constructor.call(_this,location,Y.StorageEngineHTML5.ENGINE_NAME,conf);_this._engine=window[location];_this.length=_this._engine.length;YL.later(250,_this,function(){_this.fireEvent(_this.CE_READY);});};YAHOO.lang.extend(Y.StorageEngineHTML5,Y.Storage,{_engine:null,_clear:function(){var _this=this;if(_this._engine.clear){_this._engine.clear();}
else{for(var i=_this.length,key;0<=i;i-=1){key=_this._key(i);_this._removeItem(key);}}},_getItem:function(key){var o=this._engine.getItem(key);return YL.isObject(o)?o.value:o;},_key:function(index){return this._engine.key(index);},_removeItem:function(key){var _this=this;_beginTransaction(_this._engine);_this._engine.removeItem(key);_commitTransaction(_this._engine);_this.length=_this._engine.length;},_setItem:function(key,value){var _this=this;try{_beginTransaction(_this._engine);_this._engine.setItem(key,value);_commitTransaction(_this._engine);_this.length=_this._engine.length;return true;}
catch(e){return false;}}},true);Y.StorageEngineHTML5.ENGINE_NAME='html5';Y.StorageEngineHTML5.isAvailable=function(){return window.localStorage;};Y.StorageManager.register(Y.StorageEngineHTML5);}());(function(){var Y=YAHOO.util,YL=YAHOO.lang,_SQL_STMT_LIMIT=9948,_TABLE_NAME='YUIStorageEngine',_engine=null,eURI=encodeURIComponent,dURI=decodeURIComponent;Y.StorageEngineGears=function(location,conf){var _this=this;Y.StorageEngineGears.superclass.constructor.call(_this,location,Y.StorageEngineGears.ENGINE_NAME,conf);if(!_engine){_engine=google.gears.factory.create(Y.StorageEngineGears.GEARS);_engine.open(window.location.host+'-'+Y.StorageEngineGears.DATABASE);_engine.execute('CREATE TABLE IF NOT EXISTS '+_TABLE_NAME+' (key TEXT, location TEXT, value TEXT)');}
var isSessionStorage=Y.StorageManager.LOCATION_SESSION===_this._location,sessionKey=Y.Cookie.get('sessionKey'+Y.StorageEngineGears.ENGINE_NAME);if(!sessionKey){_engine.execute('BEGIN');_engine.execute('DELETE FROM '+_TABLE_NAME+' WHERE location="'+eURI(Y.StorageManager.LOCATION_SESSION)+'"');_engine.execute('COMMIT');}
var rs=_engine.execute('SELECT key FROM '+_TABLE_NAME+' WHERE location="'+eURI(_this._location)+'"'),keyMap={};try{while(rs.isValidRow()){var fld=dURI(rs.field(0));if(!keyMap[fld]){keyMap[fld]=true;_this._addKey(fld);}
rs.next();}}
finally{rs.close();}
if(isSessionStorage){Y.Cookie.set('sessionKey'+Y.StorageEngineGears.ENGINE_NAME,true);}
_this.length=_this._keys.length;YL.later(250,_this,function(){_this.fireEvent(_this.CE_READY);});};YL.extend(Y.StorageEngineGears,Y.StorageEngineKeyed,{_clear:function(){_engine.execute('BEGIN');_engine.execute('DELETE FROM '+_TABLE_NAME+' WHERE location="'+eURI(this._location)+'"');_engine.execute('COMMIT');this._keys=[];this.length=0;},_getItem:function(key){var rs=_engine.execute('SELECT value FROM '+_TABLE_NAME+' WHERE key="'+eURI(key)+'" AND location="'+eURI(this._location)+'"'),value='';try{while(rs.isValidRow()){var temp=rs.field(0);value+=rs.field(0);rs.next();}}
finally{rs.close();}
return value?dURI(value):null;},_key:function(index){return this._keys[index];},_removeItem:function(key){YAHOO.log("removing "+key);_engine.execute('BEGIN');_engine.execute('DELETE FROM '+_TABLE_NAME+' WHERE key="'+eURI(key)+'" AND location="'+eURI(this._location)+'"');_engine.execute('COMMIT');this._removeKey(key);},_setItem:function(key,data){YAHOO.log("SETTING "+data+" to "+key);if(!this.hasKey(key)){this._addKey(key);}
var _key=eURI(key),_location=eURI(this._location),_value=eURI(data),_values=[],_len=_SQL_STMT_LIMIT-(_key+_location).length;if(_len<_value.length){for(var i=0,j=_value.length;i<j;i+=_len){_values.push(_value.substr(i,_len));}}
else{_values.push(_value);}
_engine.execute('BEGIN');_engine.execute('DELETE FROM '+_TABLE_NAME+' WHERE key="'+eURI(key)+'" AND location="'+eURI(this._location)+'"');for(var m=0,n=_values.length;m<n;m+=1){_engine.execute('INSERT INTO '+_TABLE_NAME+' VALUES ("'+_key+'", "'+_location+'", "'+_values[m]+'")');}
_engine.execute('COMMIT');return true;}});Y.Event.on('unload',function(){if(_engine){_engine.close();}});Y.StorageEngineGears.ENGINE_NAME='gears';Y.StorageEngineGears.GEARS='beta.database';Y.StorageEngineGears.DATABASE='yui.database';Y.StorageEngineGears.isAvailable=function(){if(window.google&&window.google.gears){try{google.gears.factory.create(Y.StorageEngineGears.GEARS);return true;}
catch(e){}}
return false;};Y.StorageManager.register(Y.StorageEngineGears);}());(function(){var Y=YAHOO.util,YL=YAHOO.lang,YD=Y.Dom,MINIMUM_WIDTH=215,MINIMUM_HEIGHT=138,_engine=null,_getKey=function(that,key){return that._location+that.DELIMITER+key;},_initEngine=function(cfg){if(!_engine){if(!YL.isString(cfg.swfURL)){cfg.swfURL=Y.StorageEngineSWF.SWFURL;}
if(!cfg.containerID){var bd=document.getElementsByTagName('body')[0],container=bd.appendChild(document.createElement('div'));cfg.containerID=YD.generateId(container);}
if(!cfg.attributes){cfg.attributes={};}
if(!cfg.attributes.flashVars){cfg.attributes.flashVars={};}
cfg.attributes.flashVars.useCompression='true';cfg.attributes.version=9.115;_engine=new YAHOO.widget.SWF(cfg.containerID,cfg.swfURL,cfg.attributes);}};Y.StorageEngineSWF=function(location,conf){var _this=this;Y.StorageEngineSWF.superclass.constructor.call(_this,location,Y.StorageEngineSWF.ENGINE_NAME,conf);_initEngine(_this._cfg);_engine.unsubscribe('contentReady');_engine.addListener("contentReady",function(){_this._swf=_engine._swf;_engine.initialized=true;var isSessionStorage=Y.StorageManager.LOCATION_SESSION===_this._location,sessionKey=Y.Cookie.get('sessionKey'+Y.StorageEngineSWF.ENGINE_NAME);for(var i=_engine.callSWF("getLength",[])-1;0<=i;i-=1){var key=_engine.callSWF("getNameAt",[i]),isKeySessionStorage=-1<key.indexOf(Y.StorageManager.LOCATION_SESSION+_this.DELIMITER);if(isSessionStorage&&!sessionKey){_engine.callSWF("removeItem",[key]);}
else if(isSessionStorage===isKeySessionStorage){_this._addKey(key);}}
if(isSessionStorage){Y.Cookie.set('sessionKey'+Y.StorageEngineSWF.ENGINE_NAME,true);}
_this.length=_this._keys.length;_this.fireEvent(_this.CE_READY);});if(_engine.initialized){_engine.fireEvent('contentReady');}};YL.extend(Y.StorageEngineSWF,Y.StorageEngineKeyed,{_swf:null,_clear:function(){for(var i=this._keys.length-1;0<=i;i-=1){var key=this._keys[i];_engine.callSWF("removeItem",[key]);}
this._keys=[];this.length=0;},_getItem:function(key){var _key=_getKey(this,key);return _engine.callSWF("getValueOf",[_key]);},_key:function(index){return(this._keys[index]||'').replace(/^.*?__/,'');},_removeItem:function(key){var _key=_getKey(this,key);_engine.callSWF("removeItem",[_key]);this._removeKey(_key);},_setItem:function(key,data){var _key=_getKey(this,key),swfNode;if(_engine.callSWF("getValueOf",[_key])){this._removeItem(key);}
this._addKey(_key);if(_engine.callSWF("setItem",[_key,data])){return true;}else{swfNode=YD.get(_engine._id);if(MINIMUM_WIDTH>YD.getStyle(swfNode,'width').replace(/\D+/g,'')){YD.setStyle(swfNode,'width',MINIMUM_WIDTH+'px');}
if(MINIMUM_HEIGHT>YD.getStyle(swfNode,'height').replace(/\D+/g,'')){YD.setStyle(swfNode,'height',MINIMUM_HEIGHT+'px');}
return _engine.callSWF("displaySettings",[]);}}});Y.StorageEngineSWF.SWFURL="swfstore.swf";Y.StorageEngineSWF.ENGINE_NAME='swf';Y.StorageEngineSWF.isAvailable=function(){return(6<=YAHOO.env.ua.flash&&YAHOO.widget.SWF);};Y.StorageManager.register(Y.StorageEngineSWF);}());YAHOO.register("storage",YAHOO.util.Storage,{version:"2.8.0r4",build:"2449"});
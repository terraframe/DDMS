
YAHOO.widget.LogMsg=function(oConfigs){this.msg=this.time=this.category=this.source=this.sourceDetail=null;if(oConfigs&&(oConfigs.constructor==Object)){for(var param in oConfigs){if(oConfigs.hasOwnProperty(param)){this[param]=oConfigs[param];}}}};YAHOO.widget.LogWriter=function(sSource){if(!sSource){YAHOO.log("Could not instantiate LogWriter due to invalid source.","error","LogWriter");return;}
this._source=sSource;};YAHOO.widget.LogWriter.prototype.toString=function(){return"LogWriter "+this._sSource;};YAHOO.widget.LogWriter.prototype.log=function(sMsg,sCategory){YAHOO.widget.Logger.log(sMsg,sCategory,this._source);};YAHOO.widget.LogWriter.prototype.getSource=function(){return this._source;};YAHOO.widget.LogWriter.prototype.setSource=function(sSource){if(!sSource){YAHOO.log("Could not set source due to invalid source.","error",this.toString());return;}
else{this._source=sSource;}};YAHOO.widget.LogWriter.prototype._source=null;if(!YAHOO.widget.Logger){YAHOO.widget.Logger={loggerEnabled:true,_browserConsoleEnabled:false,categories:["info","warn","error","time","window"],sources:["global"],_stack:[],maxStackEntries:2500,_startTime:new Date().getTime(),_lastTime:null,_windowErrorsHandled:false,_origOnWindowError:null};YAHOO.widget.Logger.log=function(sMsg,sCategory,sSource){if(this.loggerEnabled){if(!sCategory){sCategory="info";}
else{sCategory=sCategory.toLocaleLowerCase();if(this._isNewCategory(sCategory)){this._createNewCategory(sCategory);}}
var sClass="global";var sDetail=null;if(sSource){var spaceIndex=sSource.indexOf(" ");if(spaceIndex>0){sClass=sSource.substring(0,spaceIndex);sDetail=sSource.substring(spaceIndex,sSource.length);}
else{sClass=sSource;}
if(this._isNewSource(sClass)){this._createNewSource(sClass);}}
var timestamp=new Date();var logEntry=new YAHOO.widget.LogMsg({msg:sMsg,time:timestamp,category:sCategory,source:sClass,sourceDetail:sDetail});var stack=this._stack;var maxStackEntries=this.maxStackEntries;if(maxStackEntries&&!isNaN(maxStackEntries)&&(stack.length>=maxStackEntries)){stack.shift();}
stack.push(logEntry);this.newLogEvent.fire(logEntry);if(this._browserConsoleEnabled){this._printToBrowserConsole(logEntry);}
return true;}
else{return false;}};YAHOO.widget.Logger.reset=function(){this._stack=[];this._startTime=new Date().getTime();this.loggerEnabled=true;this.log("Logger reset");this.logResetEvent.fire();};YAHOO.widget.Logger.getStack=function(){return this._stack;};YAHOO.widget.Logger.getStartTime=function(){return this._startTime;};YAHOO.widget.Logger.disableBrowserConsole=function(){YAHOO.log("Logger output to the function console.log() has been disabled.");this._browserConsoleEnabled=false;};YAHOO.widget.Logger.enableBrowserConsole=function(){this._browserConsoleEnabled=true;YAHOO.log("Logger output to the function console.log() has been enabled.");};YAHOO.widget.Logger.handleWindowErrors=function(){if(!YAHOO.widget.Logger._windowErrorsHandled){if(window.error){YAHOO.widget.Logger._origOnWindowError=window.onerror;}
window.onerror=YAHOO.widget.Logger._onWindowError;YAHOO.widget.Logger._windowErrorsHandled=true;YAHOO.log("Logger handling of window.onerror has been enabled.");}
else{YAHOO.log("Logger handling of window.onerror had already been enabled.");}};YAHOO.widget.Logger.unhandleWindowErrors=function(){if(YAHOO.widget.Logger._windowErrorsHandled){if(YAHOO.widget.Logger._origOnWindowError){window.onerror=YAHOO.widget.Logger._origOnWindowError;YAHOO.widget.Logger._origOnWindowError=null;}
else{window.onerror=null;}
YAHOO.widget.Logger._windowErrorsHandled=false;YAHOO.log("Logger handling of window.onerror has been disabled.");}
else{YAHOO.log("Logger handling of window.onerror had already been disabled.");}};YAHOO.widget.Logger.categoryCreateEvent=new YAHOO.util.CustomEvent("categoryCreate",this,true);YAHOO.widget.Logger.sourceCreateEvent=new YAHOO.util.CustomEvent("sourceCreate",this,true);YAHOO.widget.Logger.newLogEvent=new YAHOO.util.CustomEvent("newLog",this,true);YAHOO.widget.Logger.logResetEvent=new YAHOO.util.CustomEvent("logReset",this,true);YAHOO.widget.Logger._createNewCategory=function(sCategory){this.categories.push(sCategory);this.categoryCreateEvent.fire(sCategory);};YAHOO.widget.Logger._isNewCategory=function(sCategory){for(var i=0;i<this.categories.length;i++){if(sCategory==this.categories[i]){return false;}}
return true;};YAHOO.widget.Logger._createNewSource=function(sSource){this.sources.push(sSource);this.sourceCreateEvent.fire(sSource);};YAHOO.widget.Logger._isNewSource=function(sSource){if(sSource){for(var i=0;i<this.sources.length;i++){if(sSource==this.sources[i]){return false;}}
return true;}};YAHOO.widget.Logger._printToBrowserConsole=function(oEntry){if(window.console&&console.log){var category=oEntry.category;var label=oEntry.category.substring(0,4).toUpperCase();var time=oEntry.time;var localTime;if(time.toLocaleTimeString){localTime=time.toLocaleTimeString();}
else{localTime=time.toString();}
var msecs=time.getTime();var elapsedTime=(YAHOO.widget.Logger._lastTime)?(msecs-YAHOO.widget.Logger._lastTime):0;YAHOO.widget.Logger._lastTime=msecs;var output=localTime+" ("+
elapsedTime+"ms): "+
oEntry.source+": ";if(YAHOO.env.ua.webkit){output+=oEntry.msg;}
console.log(output,oEntry.msg);}};YAHOO.widget.Logger._onWindowError=function(sMsg,sUrl,sLine){try{YAHOO.widget.Logger.log(sMsg+' ('+sUrl+', line '+sLine+')',"window");if(YAHOO.widget.Logger._origOnWindowError){YAHOO.widget.Logger._origOnWindowError();}}
catch(e){return false;}};YAHOO.widget.Logger.log("Logger initialized");}
(function(){var Logger=YAHOO.widget.Logger,u=YAHOO.util,Dom=u.Dom,Event=u.Event,d=document;function make(el,props){el=d.createElement(el);if(props){for(var p in props){if(props.hasOwnProperty(p)){el[p]=props[p];}}}
return el;}
function LogReader(elContainer,oConfigs){this._sName=LogReader._index;LogReader._index++;this._init.apply(this,arguments);if(this.autoRender!==false){this.render();}}
YAHOO.lang.augmentObject(LogReader,{_index:0,ENTRY_TEMPLATE:(function(){return make('pre',{className:'yui-log-entry'});})(),VERBOSE_TEMPLATE:"<p><span class='{category}'>{label}</span> {totalTime}ms (+{elapsedTime}) {localTime}:</p><p>{sourceAndDetail}</p><p>{message}</p>",BASIC_TEMPLATE:"<p><span class='{category}'>{label}</span> {totalTime}ms (+{elapsedTime}) {localTime}: {sourceAndDetail}: {message}</p>"});LogReader.prototype={logReaderEnabled:true,width:null,height:null,top:null,left:null,right:null,bottom:null,fontSize:null,footerEnabled:true,verboseOutput:true,entryFormat:null,newestOnTop:true,outputBuffer:100,thresholdMax:500,thresholdMin:100,isCollapsed:false,isPaused:false,draggable:true,toString:function(){return"LogReader instance"+this._sName;},pause:function(){this.isPaused=true;this._timeout=null;this.logReaderEnabled=false;if(this._btnPause){this._btnPause.value="Resume";}},resume:function(){this.isPaused=false;this.logReaderEnabled=true;this._printBuffer();if(this._btnPause){this._btnPause.value="Pause";}},render:function(){if(this.rendered){return;}
this._initContainerEl();this._initHeaderEl();this._initConsoleEl();this._initFooterEl();this._initCategories();this._initSources();this._initDragDrop();Logger.newLogEvent.subscribe(this._onNewLog,this);Logger.logResetEvent.subscribe(this._onReset,this);Logger.categoryCreateEvent.subscribe(this._onCategoryCreate,this);Logger.sourceCreateEvent.subscribe(this._onSourceCreate,this);this.rendered=true;this._filterLogs();},destroy:function(){Event.purgeElement(this._elContainer,true);this._elContainer.innerHTML='';this._elContainer.parentNode.removeChild(this._elContainer);this.rendered=false;},hide:function(){this._elContainer.style.display="none";},show:function(){this._elContainer.style.display="block";},collapse:function(){this._elConsole.style.display="none";if(this._elFt){this._elFt.style.display="none";}
this._btnCollapse.value="Expand";this.isCollapsed=true;},expand:function(){this._elConsole.style.display="block";if(this._elFt){this._elFt.style.display="block";}
this._btnCollapse.value="Collapse";this.isCollapsed=false;},getCheckbox:function(filter){return this._filterCheckboxes[filter];},getCategories:function(){return this._categoryFilters;},showCategory:function(sCategory){var filtersArray=this._categoryFilters;if(filtersArray.indexOf){if(filtersArray.indexOf(sCategory)>-1){return;}}
else{for(var i=0;i<filtersArray.length;i++){if(filtersArray[i]===sCategory){return;}}}
this._categoryFilters.push(sCategory);this._filterLogs();var elCheckbox=this.getCheckbox(sCategory);if(elCheckbox){elCheckbox.checked=true;}},hideCategory:function(sCategory){var filtersArray=this._categoryFilters;for(var i=0;i<filtersArray.length;i++){if(sCategory==filtersArray[i]){filtersArray.splice(i,1);break;}}
this._filterLogs();var elCheckbox=this.getCheckbox(sCategory);if(elCheckbox){elCheckbox.checked=false;}},getSources:function(){return this._sourceFilters;},showSource:function(sSource){var filtersArray=this._sourceFilters;if(filtersArray.indexOf){if(filtersArray.indexOf(sSource)>-1){return;}}
else{for(var i=0;i<filtersArray.length;i++){if(sSource==filtersArray[i]){return;}}}
filtersArray.push(sSource);this._filterLogs();var elCheckbox=this.getCheckbox(sSource);if(elCheckbox){elCheckbox.checked=true;}},hideSource:function(sSource){var filtersArray=this._sourceFilters;for(var i=0;i<filtersArray.length;i++){if(sSource==filtersArray[i]){filtersArray.splice(i,1);break;}}
this._filterLogs();var elCheckbox=this.getCheckbox(sSource);if(elCheckbox){elCheckbox.checked=false;}},clearConsole:function(){this._timeout=null;this._buffer=[];this._consoleMsgCount=0;var elConsole=this._elConsole;elConsole.innerHTML='';},setTitle:function(sTitle){this._title.innerHTML=this.html2Text(sTitle);},getLastTime:function(){return this._lastTime;},formatMsg:function(entry){var entryFormat=this.entryFormat||(this.verboseOutput?LogReader.VERBOSE_TEMPLATE:LogReader.BASIC_TEMPLATE),info={category:entry.category,label:entry.category.substring(0,4).toUpperCase(),sourceAndDetail:entry.sourceDetail?entry.source+" "+entry.sourceDetail:entry.source,message:this.html2Text(entry.msg||entry.message||'')};if(entry.time&&entry.time.getTime){info.localTime=entry.time.toLocaleTimeString?entry.time.toLocaleTimeString():entry.time.toString();info.elapsedTime=entry.time.getTime()-this.getLastTime();info.totalTime=entry.time.getTime()-Logger.getStartTime();}
var msg=LogReader.ENTRY_TEMPLATE.cloneNode(true);if(this.verboseOutput){msg.className+=' yui-log-verbose';}
msg.innerHTML=entryFormat.replace(/\{(\w+)\}/g,function(x,placeholder){return(placeholder in info)?info[placeholder]:'';});return msg;},html2Text:function(sHtml){if(sHtml){sHtml+="";return sHtml.replace(/&/g,"&#38;").replace(/</g,"&#60;").replace(/>/g,"&#62;");}
return"";},_sName:null,_buffer:null,_consoleMsgCount:0,_lastTime:null,_timeout:null,_filterCheckboxes:null,_categoryFilters:null,_sourceFilters:null,_elContainer:null,_elHd:null,_elCollapse:null,_btnCollapse:null,_title:null,_elConsole:null,_elFt:null,_elBtns:null,_elCategoryFilters:null,_elSourceFilters:null,_btnPause:null,_btnClear:null,_init:function(container,config){this._buffer=[];this._filterCheckboxes={};this._lastTime=Logger.getStartTime();if(config&&(config.constructor==Object)){for(var param in config){if(config.hasOwnProperty(param)){this[param]=config[param];}}}
this._elContainer=Dom.get(container);YAHOO.log("LogReader initialized",null,this.toString());},_initContainerEl:function(){if(!this._elContainer||!/div$/i.test(this._elContainer.tagName)){this._elContainer=d.body.insertBefore(make("div"),d.body.firstChild);Dom.addClass(this._elContainer,"yui-log-container");}
Dom.addClass(this._elContainer,"yui-log");var style=this._elContainer.style,styleProps=['width','right','top','fontSize'],prop,i;for(i=styleProps.length-1;i>=0;--i){prop=styleProps[i];if(this[prop]){style[prop]=this[prop];}}
if(this.left){style.left=this.left;style.right="auto";}
if(this.bottom){style.bottom=this.bottom;style.top="auto";}
if(YAHOO.env.ua.opera){d.body.style+='';}},_initHeaderEl:function(){if(this._elHd){Event.purgeElement(this._elHd,true);this._elHd.innerHTML="";}
this._elHd=make("div",{id:'yui-log-hd'+this._sName,className:"yui-log-hd"});this._elCollapse=make("div",{className:'yui-log-btns'});this._btnCollapse=make("input",{type:'button',className:'yui-log-button',value:'Collapse'});Event.on(this._btnCollapse,'click',this._onClickCollapseBtn,this);this._title=make("h4",{innerHTML:"Logger Console"});this._elCollapse.appendChild(this._btnCollapse);this._elHd.appendChild(this._elCollapse);this._elHd.appendChild(this._title);this._elContainer.appendChild(this._elHd);},_initConsoleEl:function(){if(this._elConsole){Event.purgeElement(this._elConsole,true);this._elConsole.innerHTML="";}
this._elConsole=make("div",{className:"yui-log-bd"});if(this.height){this._elConsole.style.height=this.height;}
this._elContainer.appendChild(this._elConsole);},_initFooterEl:function(){if(this.footerEnabled){if(this._elFt){Event.purgeElement(this._elFt,true);this._elFt.innerHTML="";}
this._elFt=make("div",{className:"yui-log-ft"});this._elBtns=make("div",{className:"yui-log-btns"});this._btnPause=make("input",{type:"button",className:"yui-log-button",value:"Pause"});Event.on(this._btnPause,'click',this._onClickPauseBtn,this);this._btnClear=make("input",{type:"button",className:"yui-log-button",value:"Clear"});Event.on(this._btnClear,'click',this._onClickClearBtn,this);this._elCategoryFilters=make("div",{className:"yui-log-categoryfilters"});this._elSourceFilters=make("div",{className:"yui-log-sourcefilters"});this._elBtns.appendChild(this._btnPause);this._elBtns.appendChild(this._btnClear);this._elFt.appendChild(this._elBtns);this._elFt.appendChild(this._elCategoryFilters);this._elFt.appendChild(this._elSourceFilters);this._elContainer.appendChild(this._elFt);}},_initDragDrop:function(){if(u.DD&&this.draggable&&this._elHd){var ylog_dd=new u.DD(this._elContainer);ylog_dd.setHandleElId(this._elHd.id);this._elHd.style.cursor="move";}},_initCategories:function(){this._categoryFilters=[];var aInitialCategories=Logger.categories;for(var j=0;j<aInitialCategories.length;j++){var sCategory=aInitialCategories[j];this._categoryFilters.push(sCategory);if(this._elCategoryFilters){this._createCategoryCheckbox(sCategory);}}},_initSources:function(){this._sourceFilters=[];var aInitialSources=Logger.sources;for(var j=0;j<aInitialSources.length;j++){var sSource=aInitialSources[j];this._sourceFilters.push(sSource);if(this._elSourceFilters){this._createSourceCheckbox(sSource);}}},_createCategoryCheckbox:function(sCategory){if(this._elFt){var filter=make("span",{className:"yui-log-filtergrp"}),check=make("input",{id:"yui-log-filter-"+sCategory+this._sName,className:"yui-log-filter-"+sCategory,type:"checkbox",category:sCategory}),label=make("label",{htmlFor:check.id,className:sCategory,innerHTML:sCategory});Event.on(check,'click',this._onCheckCategory,this);this._filterCheckboxes[sCategory]=check;filter.appendChild(check);filter.appendChild(label);this._elCategoryFilters.appendChild(filter);check.checked=true;}},_createSourceCheckbox:function(sSource){if(this._elFt){var filter=make("span",{className:"yui-log-filtergrp"}),check=make("input",{id:"yui-log-filter-"+sSource+this._sName,className:"yui-log-filter-"+sSource,type:"checkbox",source:sSource}),label=make("label",{htmlFor:check.id,className:sSource,innerHTML:sSource});Event.on(check,'click',this._onCheckSource,this);this._filterCheckboxes[sSource]=check;filter.appendChild(check);filter.appendChild(label);this._elSourceFilters.appendChild(filter);check.checked=true;}},_filterLogs:function(){if(this._elConsole!==null){this.clearConsole();this._printToConsole(Logger.getStack());}},_printBuffer:function(){this._timeout=null;if(this._elConsole!==null){var thresholdMax=this.thresholdMax;thresholdMax=(thresholdMax&&!isNaN(thresholdMax))?thresholdMax:500;if(this._consoleMsgCount<thresholdMax){var entries=[];for(var i=0;i<this._buffer.length;i++){entries[i]=this._buffer[i];}
this._buffer=[];this._printToConsole(entries);}
else{this._filterLogs();}
if(!this.newestOnTop){this._elConsole.scrollTop=this._elConsole.scrollHeight;}}},_printToConsole:function(aEntries){var entriesLen=aEntries.length,df=d.createDocumentFragment(),msgHTML=[],thresholdMin=this.thresholdMin,sourceFiltersLen=this._sourceFilters.length,categoryFiltersLen=this._categoryFilters.length,entriesStartIndex,i,j,msg,before;if(isNaN(thresholdMin)||(thresholdMin>this.thresholdMax)){thresholdMin=0;}
entriesStartIndex=(entriesLen>thresholdMin)?(entriesLen-thresholdMin):0;for(i=entriesStartIndex;i<entriesLen;i++){var okToPrint=false,okToFilterCats=false,entry=aEntries[i],source=entry.source,category=entry.category;for(j=0;j<sourceFiltersLen;j++){if(source==this._sourceFilters[j]){okToFilterCats=true;break;}}
if(okToFilterCats){for(j=0;j<categoryFiltersLen;j++){if(category==this._categoryFilters[j]){okToPrint=true;break;}}}
if(okToPrint){if(this._consoleMsgCount===0){this._lastTime=entry.time.getTime();}
msg=this.formatMsg(entry);if(typeof msg==='string'){msgHTML[msgHTML.length]=msg;}else{df.insertBefore(msg,this.newestOnTop?df.firstChild||null:null);}
this._consoleMsgCount++;this._lastTime=entry.time.getTime();}}
if(msgHTML.length){msgHTML.splice(0,0,this._elConsole.innerHTML);this._elConsole.innerHTML=this.newestOnTop?msgHTML.reverse().join(''):msgHTML.join('');}else if(df.firstChild){this._elConsole.insertBefore(df,this.newestOnTop?this._elConsole.firstChild||null:null);}},_onCategoryCreate:function(sType,aArgs,oSelf){var category=aArgs[0];oSelf._categoryFilters.push(category);if(oSelf._elFt){oSelf._createCategoryCheckbox(category);}},_onSourceCreate:function(sType,aArgs,oSelf){var source=aArgs[0];oSelf._sourceFilters.push(source);if(oSelf._elFt){oSelf._createSourceCheckbox(source);}},_onCheckCategory:function(v,oSelf){var category=this.category;if(!this.checked){oSelf.hideCategory(category);}
else{oSelf.showCategory(category);}},_onCheckSource:function(v,oSelf){var source=this.source;if(!this.checked){oSelf.hideSource(source);}
else{oSelf.showSource(source);}},_onClickCollapseBtn:function(v,oSelf){if(!oSelf.isCollapsed){oSelf.collapse();}
else{oSelf.expand();}},_onClickPauseBtn:function(v,oSelf){if(!oSelf.isPaused){oSelf.pause();}
else{oSelf.resume();}},_onClickClearBtn:function(v,oSelf){oSelf.clearConsole();},_onNewLog:function(sType,aArgs,oSelf){var logEntry=aArgs[0];oSelf._buffer.push(logEntry);if(oSelf.logReaderEnabled===true&&oSelf._timeout===null){oSelf._timeout=setTimeout(function(){oSelf._printBuffer();},oSelf.outputBuffer);}},_onReset:function(sType,aArgs,oSelf){oSelf._filterLogs();}};YAHOO.widget.LogReader=LogReader;})();YAHOO.register("logger",YAHOO.widget.Logger,{version:"2.8.0r4",build:"2449"});
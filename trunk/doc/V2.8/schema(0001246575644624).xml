<!--
  Copyright (C) 2018 IVCC
  
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  
  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<version xsi:noNamespaceSchemaLocation="../../profiles/version_gis.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <doIt>
    <create>

      <mdView
        name="dss.vector.solutions.query.LayerView"
        label="Layer View"
        description="Simple view to represent a thematic or universal layer">
        <attributes>
          <char
            name="layerId"
            size="64"
            label="Layer Id"
            required="true"/>
          <boolean
            name="isThematic"
            label="Is Thematic"
            description="Denotes if the layer is Thematic"
            required="true"/>
          <char
            name="universalType"
            label="Universal Type"
            description="The GeoHierarchy type that the layer represents as a universal layer."
            required="false"
            size="255"/>
          <char
            name="thematicType"
            label="Thematic Type"
            description="The GeoHiearchy type that the layer represents as a thematic layer. "
            required="false"
            size="255"/>
        </attributes>
      </mdView>

      <mdProblem
        name="dss.vector.solutions.irs.HouseholdValueNotApplicableProblem"
        label="Value not Applicable Problem"
        description="Household value is not applicable on a mop-up spray"
        extends="dss.vector.solutions.irs.ValueNotApplicableProblem"/>

      <mdProblem
        name="dss.vector.solutions.irs.PrevSprayedHouseholdValueNotApplicableProblem"
        label="Value not Applicable Problem"
        description="Household value is not applicable on a mop-up spray"
        extends="dss.vector.solutions.irs.ValueNotApplicableProblem"/>

      <mdProblem
        name="dss.vector.solutions.irs.RoomValueNotApplicableProblem"
        label="Value not Applicable Problem"
        description="Household value is not applicable on a mop-up spray"
        extends="dss.vector.solutions.irs.ValueNotApplicableProblem"/>

      <mdProblem
        name="dss.vector.solutions.irs.HouseholdValueProblem"
        label="Total Problem"
        description="The value may only be a 0 or 1"
        extends="dss.vector.solutions.irs.ValueProblem" />

      <mdProblem
        name="dss.vector.solutions.irs.StructureValueProblem"
        label="Total Problem"
        description="The value may only be a 0 or 1"
        extends="dss.vector.solutions.irs.ValueProblem" />

      <mdProblem
        name="dss.vector.solutions.irs.SprayedHouseholdValueProblem"
        label="Total Problem"
        description="The value may only be a 0 or 1"
        extends="dss.vector.solutions.irs.ValueProblem" />

      <mdProblem
        name="dss.vector.solutions.irs.SprayedStructureValueProblem"
        label="Total Problem"
        description="The value may only be a 0 or 1"
        extends="dss.vector.solutions.irs.ValueProblem" />

      <mdProblem
        name="dss.vector.solutions.irs.PrevSprayedHouseholdValueProblem"
        label="Total Problem"
        description="The value may only be a 0 or 1"
        extends="dss.vector.solutions.irs.ValueProblem" />

      <mdProblem
        name="dss.vector.solutions.irs.PrevSprayedStructureValueProblem"
        label="Total Problem"
        description="The value may only be a 0 or 1"
        extends="dss.vector.solutions.irs.ValueProblem" />

    </create>
    <update>
    
      <mdBusiness name="dss.vector.solutions.query.SavedSearch">
        <create>
          <mdMethod
            name="getAllLayers"
            label="Get All Layers"
            description="Get All Layers"
            static="false"
            returnType="dss.vector.solutions.query.LayerView[]">
          </mdMethod>
        </create>
      </mdBusiness>  
    
      <mdBusiness
        name="dss.vector.solutions.intervention.monitor.SurveyPoint">
        <create>
        <mdMethod
          name="querySurvey"
          label="Query Survey"
          description="Query Survey"
          static="true"
          returnType="com.runwaysdk.query.ValueQuery">
          <mdParameter
            name="queryXML"
            label="Query XML"
            description="Query XML"
            order="0"
            type="java.lang.String" />
          <mdParameter
            name="config"
            label="config"
            description="JSON config"
            order="1"
            type="java.lang.String" />
          <mdParameter
            name="sortBy"
            label="Sort By"
            type="java.lang.String"
            order="2" />
          <mdParameter
            name="ascending"
            label="Ascending"
            type="java.lang.Boolean"
            order="3" />
          <mdParameter
            name="pageNumber"
            label="Page Number"
            type="java.lang.Integer"
            order="4" />
        </mdMethod>
        <mdMethod
          name="exportQueryToExcel"
          label="Export Query To Excel"
          static="true"
          returnType="java.io.InputStream">
          <mdParameter
            name="queryXML"
            label="Query XML"
            description="Query XML"
            order="0"
            type="java.lang.String"/>
          <mdParameter
            name="config"
            label="config"
            description="JSON config"
            order="1"
            type="java.lang.String" />
           <mdParameter
             name="savedSearchId"
             label="Saved Search Id"
             order="2"
             type="java.lang.String"/>
        </mdMethod>
        <mdMethod
          name="exportQueryToCSV"
          label="Export Query To CSV"
          static="true"
          returnType="java.io.InputStream">
          <mdParameter
            name="queryXML"
            label="Query XML"
            description="Query XML"
            order="0"
            type="java.lang.String"/>
          <mdParameter
            name="config"
            label="config"
            description="JSON config"
            order="1"
            type="java.lang.String" />
           <mdParameter
             name="savedSearchId"
             label="Saved Search Id"
             order="2"
             type="java.lang.String"/>
        </mdMethod>
        <mdMethod
          name="mapQuery"
          label="Map Query"
          description="Map Query"
          static="true"
          returnType="java.lang.String">
          <mdParameter
            name="queryXML"
            label="Query XML"
            description="Query XML"
            order="0"
            type="java.lang.String" />
          <mdParameter
            name="config"
            label="Query Configuration"
            description="The query configuration"
            order="1"
            type="java.lang.String" />
          <mdParameter
            name="universalLayers"
            label="Universal Layers"
            description="The universal types that will act as additional layers"
            order="2"
            type="java.lang.String[]" />
          <mdParameter
            name="savedSearchId"
            label="SavedSearch Id"
            description="The id of the SavedSearch for which the map will be generated."
            order="3"
            type="java.lang.String" />
        </mdMethod>
        </create>
      </mdBusiness>
      
      <mdController
        name="dss.vector.solutions.query.QueryController">
        <create>
          <mdAction
            name="querySurvey"
            label="Query Survey"
            description="Query Survey"
            isPost="false" />
          <mdAction
            name="exportSurveyQueryToCSV"
            label="Export Query To CSV"
            isPost="true">
            <mdParameter
              name="queryXML"
              label="Query XML"
              description="Query XML"
              order="0"
              type="java.lang.String" />
            <mdParameter
              name="config"
              label="JSON config"
              description="The query configuration"
              order="1"
              type="java.lang.String" />
            <mdParameter
              name="savedSearchId"
              label="Saved Search Id"
              order="2"
              type="java.lang.String" />
          </mdAction>
          <mdAction
            name="exportSurveyQueryToExcel"
            label="Export Aggregated Query To Excel"
            isPost="true">
            <mdParameter
              name="queryXML"
              label="Query XML"
              description="Query XML"
              order="0"
              type="java.lang.String" />
            <mdParameter
              name="config"
              label="Config"
              description="The type on which to gather spatial data"
              order="1"
              type="java.lang.String" />
            <mdParameter
              name="savedSearchId"
              label="Saved Search Id"
              order="2"
              type="java.lang.String" />
          </mdAction>
        </create>
      </mdController>
      
      <mdBusiness name="dss.vector.solutions.query.ThematicLayer">
        <create>
          <mdMethod
            name="changeLayerType"
            label="Change Layer Type"
            description="Changes the type of universal layer this thematic layer users."
            static="false"
            returnType="void">
              <mdParameter
              name="thematicLayerType"
              label="Thematic Layer Type"
              order="0"
              type="java.lang.String" />
            </mdMethod>
        </create>
      </mdBusiness>       
      
    </update>
  </doIt>
  <undoIt>
    <delete></delete>
  </undoIt>
</version>

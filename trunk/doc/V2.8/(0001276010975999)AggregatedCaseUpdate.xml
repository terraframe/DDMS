<!--
  Copyright (C) 2018 IVCC
  
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
  
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
  
  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<version
  xsi:noNamespaceSchemaLocation="../../profiles/version_gis.xsd"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <doIt>
    <create>
      <mdBusiness
        name="dss.vector.solutions.surveillance.CaseStockReferral"
        label="Case Treatment Stock"
        generateController="false">
        <attributes>
          <reference
            name="aggregatedCase"
            label="Case"
            type="dss.vector.solutions.surveillance.AggregatedCase"
            required="true" />
          <reference
            name="term"
            label="Case referrals and treatment stock shortage"
            type="dss.vector.solutions.ontology.Term"
            required="true" />
          <integer
            name="amount"
            label="Number"
            rejectNegative="true" />
        </attributes>
      </mdBusiness>

      <mdIndex
        type="dss.vector.solutions.surveillance.CaseStockReferral"
        label="Case Treatment stock view"
        active="true"
        unique="true">
        <attribute
          name="aggregatedCase"
          indexOrder="0" />
        <attribute
          name="term"
          indexOrder="1" />
      </mdIndex>

      <mdView
        name="dss.vector.solutions.surveillance.CaseStockReferralView"
        label="Case Treatment Stock">
        <attributes>
          <char
            name="concreteId"
            label="Concrete Id"
            required="true"
            size="64" />
          <virtual
            concrete="aggregatedCase"
            type="dss.vector.solutions.surveillance.CaseStockReferral" />
          <virtual
            concrete="term"
            type="dss.vector.solutions.surveillance.CaseStockReferral" />
          <virtual
            concrete="amount"
            type="dss.vector.solutions.surveillance.CaseStockReferral" />
        </attributes>
      </mdView>

      <mdBusiness
        name="dss.vector.solutions.surveillance.CaseDiagnosisType"
        label="Type of diagnosis"
        generateController="false">
        <attributes>
          <reference
            name="aggregatedCase"
            label="Case"
            type="dss.vector.solutions.surveillance.AggregatedCase"
            required="true" />
          <reference
            name="term"
            label="Type of diagnosis"
            type="dss.vector.solutions.ontology.Term"
            required="true" />
        </attributes>
      </mdBusiness>

      <mdIndex
        type="dss.vector.solutions.surveillance.CaseDiagnosisType"
        label="Case Diagnosis Type Index"
        active="true"
        unique="true">
        <attribute
          name="aggregatedCase"
          indexOrder="0" />
        <attribute
          name="term"
          indexOrder="1" />
      </mdIndex>

      <mdTree
        name="dss.vector.solutions.surveillance.CaseDiagnosisTypeAmount"
        label="Type of diagnosis amount"
        generateController="false">
        <attributes>
          <integer
            name="amount"
            label="Number"
            rejectNegative="true" />
        </attributes>
        <parent
          cardinality="*"
          name="dss.vector.solutions.surveillance.CaseDiagnosisType"
          method="CaseDiagnosisTypes" />
        <child
          cardinality="*"
          name="dss.vector.solutions.ontology.Term"
          method="Categories" />
      </mdTree>

      <mdView
        name="dss.vector.solutions.surveillance.CaseDiagnosisTypeView"
        label="Type of diagnosis">
        <attributes>
          <char
            name="concreteId"
            label="Concrete Id"
            size="64"
            required="true" />
          <virtual
            concrete="aggregatedCase"
            type="dss.vector.solutions.surveillance.CaseDiagnosisType" />
          <virtual
            concrete="term"
            type="dss.vector.solutions.surveillance.CaseDiagnosisType" />
          <reference
            name="diagnosisCategory"
            label="Diagnosis Category"
            type="dss.vector.solutions.ontology.Term" />
        </attributes>
        <mdMethod
          name="getAmounts"
          label="Get Amounts"
          static="false"
          returnType="dss.vector.solutions.surveillance.CaseDiagnosisTypeAmountView[]">
        </mdMethod>
        <mdMethod
          name="getAmountsForViews"
          label="Get Amounts For Views"
          static="true"
          returnType="dss.vector.solutions.surveillance.CaseDiagnosisTypeAmountView[][]">
          <mdParameter
            name="ids"
            order="0"
            type="java.lang.String[]"
            label="Ids" />
        </mdMethod>
      </mdView>

      <mdView
        name="dss.vector.solutions.surveillance.CaseDiagnosisTypeAmountView"
        label="Intervention Method Used">
        <attributes>
          <reference
            name="diagnosis"
            label="Diagnosis"
            type="dss.vector.solutions.surveillance.CaseDiagnosisType"
            required="true" />
          <reference
            name="term"
            label="Term"
            type="dss.vector.solutions.ontology.Term"
            required="true" />
          <virtual
            concrete="amount"
            type="dss.vector.solutions.surveillance.CaseDiagnosisTypeAmount" />
        </attributes>
      </mdView>

      <mdBusiness
        name="dss.vector.solutions.surveillance.CaseDiseaseManifestation"
        label="Disease manifestation"
        generateController="false">
        <attributes>
          <reference
            name="aggregatedCase"
            label="Case"
            type="dss.vector.solutions.surveillance.AggregatedCase"
            required="true" />
          <reference
            name="term"
            label="Disease manifestation"
            type="dss.vector.solutions.ontology.Term"
            required="true" />
        </attributes>
      </mdBusiness>

      <mdIndex
        type="dss.vector.solutions.surveillance.CaseDiseaseManifestation"
        label="Disease Manifestation Index"
        active="true"
        unique="true">
        <attribute
          name="aggregatedCase"
          indexOrder="0" />
        <attribute
          name="term"
          indexOrder="1" />
      </mdIndex>

      <mdTree
        name="dss.vector.solutions.surveillance.CaseDiseaseManifestationAmount"
        label="Type of diagnosis amount"
        generateController="false">
        <attributes>
          <integer
            name="amount"
            label="Number"
            rejectNegative="true" />
        </attributes>
        <parent
          cardinality="*"
          name="dss.vector.solutions.surveillance.CaseDiseaseManifestation"
          method="CaseDiseaseManifestations" />
        <child
          cardinality="*"
          name="dss.vector.solutions.ontology.Term"
          method="Diseases" />
      </mdTree>

      <mdView
        name="dss.vector.solutions.surveillance.CaseDiseaseManifestationView"
        label="Disease manifestation">
        <attributes>
          <char
            name="concreteId"
            label="Concrete Id"
            size="64"
            required="true" />
          <virtual
            concrete="aggregatedCase"
            type="dss.vector.solutions.surveillance.CaseDiseaseManifestation" />
          <virtual
            concrete="term"
            type="dss.vector.solutions.surveillance.CaseDiseaseManifestation" />
          <reference
            name="diseaseCategory"
            label="Disease Category"
            type="dss.vector.solutions.ontology.Term" />
        </attributes>
        <mdMethod
          name="getAmounts"
          label="Get Amounts"
          static="false"
          returnType="dss.vector.solutions.surveillance.CaseDiseaseManifestationAmountView[]">
        </mdMethod>
        <mdMethod
          name="getAmountsForViews"
          label="Get Amounts For Views"
          static="true"
          returnType="dss.vector.solutions.surveillance.CaseDiseaseManifestationAmountView[][]">
          <mdParameter
            name="ids"
            order="0"
            type="java.lang.String[]"
            label="Ids" />
        </mdMethod>
      </mdView>

      <mdView
        name="dss.vector.solutions.surveillance.CaseDiseaseManifestationAmountView"
        label="Intervention Method Used">
        <attributes>
          <reference
            name="manifestation"
            label="Manifestation"
            type="dss.vector.solutions.surveillance.CaseDiseaseManifestation"
            required="true" />
          <reference
            name="term"
            label="Term"
            type="dss.vector.solutions.ontology.Term"
            required="true" />
          <virtual
            concrete="amount"
            type="dss.vector.solutions.surveillance.CaseDiseaseManifestationAmount" />
        </attributes>
      </mdView>

      <mdBusiness
        name="dss.vector.solutions.surveillance.CasePatientType"
        label="Disease manifestation"
        generateController="false">
        <attributes>
          <reference
            name="aggregatedCase"
            label="Case"
            type="dss.vector.solutions.surveillance.AggregatedCase"
            required="true" />
          <reference
            name="term"
            label="Type of patient"
            type="dss.vector.solutions.ontology.Term"
            required="true" />
        </attributes>
      </mdBusiness>

      <mdIndex
        type="dss.vector.solutions.surveillance.CasePatientType"
        label="Type of patient Index"
        active="true"
        unique="true">
        <attribute
          name="aggregatedCase"
          indexOrder="0" />
        <attribute
          name="term"
          indexOrder="1" />
      </mdIndex>

      <mdTree
        name="dss.vector.solutions.surveillance.CasePatientTypeAmount"
        label="Type of patient amount"
        generateController="false">
        <attributes>
          <integer
            name="amount"
            label="Number"
            rejectNegative="true" />
        </attributes>
        <parent
          cardinality="*"
          name="dss.vector.solutions.surveillance.CasePatientType"
          method="CasePatientTypes" />
        <child
          cardinality="*"
          name="dss.vector.solutions.ontology.Term"
          method="Patients" />
      </mdTree>

      <mdView
        name="dss.vector.solutions.surveillance.CasePatientTypeView"
        label="Type of patient">
        <attributes>
          <char
            name="concreteId"
            label="Concrete Id"
            size="64"
            required="true" />
          <virtual
            concrete="aggregatedCase"
            type="dss.vector.solutions.surveillance.CasePatientType" />
          <virtual
            concrete="term"
            type="dss.vector.solutions.surveillance.CasePatientType" />
          <reference
            name="patientCategory"
            label="Patient Category"
            type="dss.vector.solutions.ontology.Term" />
        </attributes>
        <mdMethod
          name="getAmounts"
          label="Get Amounts"
          static="false"
          returnType="dss.vector.solutions.surveillance.CasePatientTypeAmountView[]">
        </mdMethod>
        <mdMethod
          name="getAmountsForViews"
          label="Get Amounts For Views"
          static="true"
          returnType="dss.vector.solutions.surveillance.CasePatientTypeAmountView[][]">
          <mdParameter
            name="ids"
            order="0"
            type="java.lang.String[]"
            label="Ids" />
        </mdMethod>
      </mdView>

      <mdView
        name="dss.vector.solutions.surveillance.CasePatientTypeAmountView"
        label="Patient Type Amount">
        <attributes>
          <reference
            name="patient"
            label="patient"
            type="dss.vector.solutions.surveillance.CasePatientType"
            required="true" />
          <reference
            name="term"
            label="Term"
            type="dss.vector.solutions.ontology.Term"
            required="true" />
          <virtual
            concrete="amount"
            type="dss.vector.solutions.surveillance.CasePatientTypeAmount" />
        </attributes>
      </mdView>

    </create>
    <update>
      <mdView
        name="dss.vector.solutions.surveillance.AggregatedCaseView"
        label="Aggregated Case"
        extendable="true">
        <mdMethod
          name="applyAll"
          static="false"
          returnType="void"
          label="Apply All"
          description="Apply an aggregated case and all of its corresponding grids">
          <create>
            <mdParameter
              name="stockReferrals"
              type="dss.vector.solutions.surveillance.CaseStockReferralView[]"
              order="6"
              label="Stock Referrals" />
            <mdParameter
              name="diagnosticTypes"
              type="dss.vector.solutions.surveillance.CaseDiagnosisTypeView[]"
              order="7"
              label="Diagnostic Types" />
            <mdParameter
              name="diagnosticTypeAmounts"
              type="dss.vector.solutions.surveillance.CaseDiagnosisTypeAmountView[][]"
              order="8"
              label="Diagnostic Type Amounts" />
            <mdParameter
              name="diseaseManifestations"
              type="dss.vector.solutions.surveillance.CaseDiseaseManifestationView[]"
              order="9"
              label="Disease Manifestation" />
            <mdParameter
              name="diseaseManifestationAmounts"
              type="dss.vector.solutions.surveillance.CaseDiseaseManifestationAmountView[][]"
              order="10"
              label="Diagnostic Type Amounts" />
            <mdParameter
              name="patientTypes"
              type="dss.vector.solutions.surveillance.CasePatientTypeView[]"
              order="11"
              label="Disease Manifestation" />
            <mdParameter
              name="patientTypeAmounts"
              type="dss.vector.solutions.surveillance.CasePatientTypeAmountView[][]"
              order="12"
              label="Diagnostic Type Amounts" />
          </create>
        </mdMethod>
        <create>
          <attributes>
            <reference
              name="caseStockReferral"
              label="Case referrals and treatment stock shortage"
              required="false"
              type="dss.vector.solutions.ontology.Term" />
            <reference
              name="caseDiagnosisType"
              label="Type of diagnosis"
              required="false"
              type="dss.vector.solutions.ontology.Term" />
            <reference
              name="caseDiseaseManifestation"
              label="Disease manifestation"
              required="false"
              type="dss.vector.solutions.ontology.Term" />
            <reference
              name="casePatientType"
              label="Type of patient"
              required="false"
              type="dss.vector.solutions.ontology.Term" />
          </attributes>
          <mdMethod
            name="getStockReferrals"
            label="getStockReferrals"
            static="false"
            returnType="dss.vector.solutions.surveillance.CaseStockReferralView[]" />
          <mdMethod
            name="getDiagnosticTypes"
            label="Get Diagnostic Types"
            static="false"
            returnType="dss.vector.solutions.surveillance.CaseDiagnosisTypeView[]" />
          <mdMethod
            name="getDiseaseManifestations"
            label="Get Disease Manifestations"
            static="false"
            returnType="dss.vector.solutions.surveillance.CaseDiseaseManifestationView[]" />
          <mdMethod
            name="getPatientTypes"
            label="Get Patient Types"
            static="false"
            returnType="dss.vector.solutions.surveillance.CasePatientTypeView[]" />
        </create>
      </mdView>
      <mdBusiness
        name="dss.vector.solutions.ontology.Term">
        <create>
          <mdMethod
            name="getSortedRootChildren"
            label="Get Sorted Root Children"
            returnType="dss.vector.solutions.ontology.Term[]"
            static="true">
            <mdParameter
              name="className"
              label="Class Name"
              order="0"
              type="java.lang.String" />
            <mdParameter
              name="attributeName"
              label="Attribute Name"
              order="1"
              type="java.lang.String" />
            <mdParameter
              name="returnOnlySelectable"
              label="Return Only Selectable"
              order="2"
              type="java.lang.Boolean" />
          </mdMethod>
        </create>
      </mdBusiness>
    </update>
    <create>
      <object
        key="Ontology__dss.vector.solutions.surveillance.AggregatedCaseView.caseStockReferral"
        type="dss.vector.solutions.ontology.BrowserField">
        <attributeReference
          name="mdAttribute"
          key="dss.vector.solutions.surveillance.AggregatedCaseView.caseStockReferral" />
      </object>
      <object
        key="Ontology__dss.vector.solutions.surveillance.AggregatedCaseView.caseDiagnosisType"
        type="dss.vector.solutions.ontology.BrowserField">
        <attributeReference
          name="mdAttribute"
          key="dss.vector.solutions.surveillance.AggregatedCaseView.caseDiagnosisType" />
      </object>
      <object
        key="Ontology__dss.vector.solutions.surveillance.AggregatedCaseView.caseDiseaseManifestation"
        type="dss.vector.solutions.ontology.BrowserField">
        <attributeReference
          name="mdAttribute"
          key="dss.vector.solutions.surveillance.AggregatedCaseView.caseDiseaseManifestation" />
      </object>
      <object
        key="Ontology__dss.vector.solutions.surveillance.AggregatedCaseView.casePatientType"
        type="dss.vector.solutions.ontology.BrowserField">
        <attributeReference
          name="mdAttribute"
          key="dss.vector.solutions.surveillance.AggregatedCaseView.casePatientType" />
      </object>

      <object
        key="Ontology__dss.vector.solutions.surveillance.CaseDiagnosisTypeView.diagnosisCategory"
        type="dss.vector.solutions.ontology.BrowserField">
        <attributeReference
          name="mdAttribute"
          key="dss.vector.solutions.surveillance.CaseDiagnosisTypeView.diagnosisCategory" />
      </object>
      <object
        key="Ontology__dss.vector.solutions.surveillance.CaseDiseaseManifestationView.diseaseCategory"
        type="dss.vector.solutions.ontology.BrowserField">
        <attributeReference
          name="mdAttribute"
          key="dss.vector.solutions.surveillance.CaseDiseaseManifestationView.diseaseCategory" />
      </object>
      <object
        key="Ontology__dss.vector.solutions.surveillance.CasePatientTypeView.patientCategory"
        type="dss.vector.solutions.ontology.BrowserField">
        <attributeReference
          name="mdAttribute"
          key="dss.vector.solutions.surveillance.CasePatientTypeView.patientCategory" />
      </object>
    </create>
  </doIt>
  <undoIt>
    <delete>
      <object
        key="Ontology__dss.vector.solutions.surveillance.CasePatientTypeView.patientCategory"
        type="dss.vector.solutions.ontology.BrowserField" />
      <object
        key="Ontology__dss.vector.solutions.surveillance.AggregatedCaseView.casePatientType"
        type="dss.vector.solutions.ontology.BrowserField" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.getPatientTypes"
        type="com.runwaysdk.system.metadata.MdMethod" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.casePatientType"
        type="com.runwaysdk.system.metadata.MdAttribute" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.applyAll.patientTypeAmounts"
        type="com.runwaysdk.system.metadata.MdParameter" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.applyAll.patientTypes"
        type="com.runwaysdk.system.metadata.MdParameter" />
      <object
        key="dss.vector.solutions.surveillance.CasePatientTypeAmountView"
        type="com.runwaysdk.system.metadata.MdView" />
      <object
        key="dss.vector.solutions.surveillance.CasePatientTypeView"
        type="com.runwaysdk.system.metadata.MdView" />
      <object
        key="dss.vector.solutions.surveillance.CasePatientTypeAmount"
        type="com.runwaysdk.system.metadata.MdRelationship" />
      <object
        key="dss.vector.solutions.surveillance.CasePatientType"
        type="com.runwaysdk.system.metadata.MdBusiness" />
        
      <object
        key="Ontology__dss.vector.solutions.surveillance.CaseDiseaseManifestationView.diseaseCategory"
        type="dss.vector.solutions.ontology.BrowserField" />
      <object
        key="Ontology__dss.vector.solutions.surveillance.AggregatedCaseView.caseDiseaseManifestation"
        type="dss.vector.solutions.ontology.BrowserField" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.getDiseaseManifestations"
        type="com.runwaysdk.system.metadata.MdMethod" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.caseDiseaseManifestation"
        type="com.runwaysdk.system.metadata.MdAttribute" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.applyAll.diseaseManifestationAmounts"
        type="com.runwaysdk.system.metadata.MdParameter" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.applyAll.diseaseManifestations"
        type="com.runwaysdk.system.metadata.MdParameter" />
      <object
        key="dss.vector.solutions.surveillance.CaseDiseaseManifestationAmountView"
        type="com.runwaysdk.system.metadata.MdView" />
      <object
        key="dss.vector.solutions.surveillance.CaseDiseaseManifestationView"
        type="com.runwaysdk.system.metadata.MdView" />
      <object
        key="dss.vector.solutions.surveillance.CaseDiseaseManifestationAmount"
        type="com.runwaysdk.system.metadata.MdRelationship" />
      <object
        key="dss.vector.solutions.surveillance.CaseDiseaseManifestation"
        type="com.runwaysdk.system.metadata.MdBusiness" />
        
        
      <object
        key="dss.vector.solutions.ontology.Term.getSortedRootChildren"
        type="com.runwaysdk.system.metadata.MdMethod" />


      <object
        key="Ontology__dss.vector.solutions.surveillance.AggregatedCaseView.caseDiagnosisType"
        type="dss.vector.solutions.ontology.BrowserField" />
      <object
        key="Ontology__dss.vector.solutions.surveillance.CaseDiagnosisTypeView.diagnosisCategory"
        type="dss.vector.solutions.ontology.BrowserField" />
      <object
        key="Ontology__dss.vector.solutions.surveillance.AggregatedCaseView.caseStockReferral"
        type="dss.vector.solutions.ontology.BrowserField" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.getStockReferrals"
        type="com.runwaysdk.system.metadata.MdMethod" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.getDiagnosticTypes"
        type="com.runwaysdk.system.metadata.MdMethod" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.caseStockReferral"
        type="com.runwaysdk.system.metadata.MdAttribute" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.caseDiagnosisType"
        type="com.runwaysdk.system.metadata.MdAttribute" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.applyAll.diagnosticTypeAmounts"
        type="com.runwaysdk.system.metadata.MdParameter" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.applyAll.diagnosticTypes"
        type="com.runwaysdk.system.metadata.MdParameter" />
      <object
        key="dss.vector.solutions.surveillance.AggregatedCaseView.applyAll.stockReferrals"
        type="com.runwaysdk.system.metadata.MdParameter" />
      <object
        key="dss.vector.solutions.surveillance.CaseDiagnosisTypeAmountView"
        type="com.runwaysdk.system.metadata.MdView" />
      <object
        key="dss.vector.solutions.surveillance.CaseDiagnosisTypeView"
        type="com.runwaysdk.system.metadata.MdView" />
      <object
        key="dss.vector.solutions.surveillance.CaseDiagnosisTypeAmount"
        type="com.runwaysdk.system.metadata.MdRelationship" />
      <object
        key="dss.vector.solutions.surveillance.CaseDiagnosisType"
        type="com.runwaysdk.system.metadata.MdBusiness" />
      <object
        key="dss.vector.solutions.surveillance.CaseStockReferralView"
        type="com.runwaysdk.system.metadata.MdView" />
      <object
        key="dss.vector.solutions.surveillance.CaseStockReferral"
        type="com.runwaysdk.system.metadata.MdBusiness" />
    </delete>
  </undoIt>
</version>
